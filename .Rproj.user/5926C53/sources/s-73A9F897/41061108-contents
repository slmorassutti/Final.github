# Main directory for Final Project
# Created by Sam Morassutti
# Feb 2020
# R.version.string
#"R version 3.6.2 (2019-12-12)"

# libraries needed
library(dplyr)
#
#
#


#setup working directory pathway
working.dir <- getwd()

# create all folders for this project so that it is organized & reproducible 
# store future file names in an object... These are base folder names
output.folder.names <- c("Clean Folder", "Figures",
                         "Raw Data","Final R scripts","Potential Analysis",
                         "Relevant Analysis","Results","Extra R scripts")

# make all folders for this project
# and make the folders if they don't exit yet.
for(i in 1:length(output.folder.names))
  if(file.exists(output.folder.names[i]) == FALSE)
    dir.create(output.folder.names[i])
#these are the pathways which are necessary to send graphs to the folders.
path.clean <- paste(working.dir, "/", output.folder.names[1], "/", sep = "")
path.figures<- paste(working.dir, "/", output.folder.names[2], "/", sep = "")
path.raw.data<- paste(working.dir, "/", output.folder.names[3], "/", sep = "")
path.finalR<- paste(working.dir, "/", output.folder.names[4], "/", sep = "")
path.potan<- paste(working.dir, "/", output.folder.names[5], "/", sep = "")
path.finan<- paste(working.dir, "/", output.folder.names[6], "/", sep = "")
path.results<- paste(working.dir, "/", output.folder.names[7], "/", sep = "")
path.extr<- paste(working.dir, "/", output.folder.names[8], "/", sep = "")

#
# This file is the first step in my final project
# It is intended for me to familiorize myself with how to construct a heatmap
# Created by Sam Morassutti
#
#
#
# libraries needed
library(devtools)
install_github("jokergoo/ComplexHeatmap")
library(circlize)
library(cluster)

# index 







# This file is the first step in my final project
# It is intended for me to familiorize myself with how to construct a heatmap
# Created by Sam Morassutti
#
#
#
# libraries needed
library(devtools)
install_github("jokergoo/ComplexHeatmap")
library(circlize)
library(cluster)

# index 



#----------------------------------------------
#----- 1 Generate a random matrix---------------
#----------------------------------------------
# this random matrix will have three groups by columns
# and three groups by rows

# use the fucntion set.seed to generate random numbers
?set.seed

set.seed(123)
nr1 = 4; nr2 = 8; nr3 = 6; nr = nr1 + nr2 + nr3
nc1 = 6; nc2 = 8; nc3 = 10; nc = nc1 + nc2 + nc3 

# now let's combine all of the rows and columns in a matrix 
# let's call the matrix object mat!
mat = cbind(rbind(matrix(rnorm(nr1 * nc1, mean = 1, sd = 0.5), nr = nr1),
                  matrix(rnorm(nr2 * nc1, mean = 0, sd = 0.5), nr = nr2),
                  matrix(rnorm(nr3 * nc1, mean = 0, sd = 0.5), nr = nr3)),
            rbind(matrix(rnorm(nr1 * nc2, mean = 0, sd = 0.5), nr = nr1),
                  matrix(rnorm(nr2 * nc2, mean = 1, sd = 0.5), nr = nr2),
                  matrix(rnorm(nr3 * nc2, mean = 0, sd = 0.5), nr = nr3)),
            rbind(matrix(rnorm(nr1 * nc3, mean = 0.5, sd = 0.5), nr = nr1),
                  matrix(rnorm(nr2 * nc3, mean = 0.5, sd = 0.5), nr = nr2),
                  matrix(rnorm(nr3 * nc3, mean = 1, sd = 0.5), nr = nr3)))
# Now let's shuffle the rows and columns randomly 
mat = mat[sample(nr, nr), sample(nc, nc)] 
rownames(mat) = paste0("row", seq_len(nr))
colnames(mat) = paste0("column", seq_len(nc))
str(mat)
# Great! Now we have a random data matrix called mat
# that has 24 columns and 18 rows
mat
# woah those are some interesting numbers
# let's check the range by using the min and max function
min(mat) # -1.154584
max(mat) # 2.62052
# Now let's visualize this random data and create a heatmap with default settings
ComplexHeatmap::Heatmap(mat)

# save as pdf and send to figures of interest folder!
pdf(file=paste(path.figures,"Default Random Heatmap.pdf",sep="/"))
heat.colors(mat)
dev.off()





ComplexHeatmap::Heatmap(mat)
# save as pdf and send to figures of interest folder!
pdf(file = paste(path.figures,"Default Random Heatmap.pdf",sep="/"))
heatmap(mat)
dev.off()



#---------- colours----------
# colours are a veyr important compoent of representation of data in the matrix
# colour mapping functions
#allow you to create a fucntion in which a vector of values will result
# in the correspond colours

# If using heatmap(), always use the circlcolorRam2() in order to make a color
# mapping function
# there are two arguements in the colorRamp2
# a vector of break values and their corresponding colors 


# create a color scheme that corresponds to the set values with a rang of -2 to 2
# in this map, the colors aren't affected by outliers
# the color mapping function is robost to outliers

col_fun = colorRamp2(c(-2, 0, 2), c("mediumvioletred", "white", "mediumspringgreen"))
col.fun <- col_fun(seq(-3, 3))
ComplexHeatmap::Heatmap(mat, col = col.fun)
# the negative values are mediumvioletred and the positive are mediumspringgreen


# can also create a rainbow color scheme 
ComplexHeatmap::Heatmap(mat, name = "mat", col = rev(rainbow(10)))

# if matrix is continuous, provide a vector of colours 
# the colours will be interpolated linearly
# however, mapping isn't robust against outliers
# becasue it starts with the min and max values
# in the matrix

# therefore, if you set the colour to the max/min
# of the matrix, it will be identical to the
# default plot


# can also have colours for a discrete numeric matrix
# and also for character matrix
# default clustering will be applied in the dsicrete plot
# and can be in character plots too if set 



# -----NA---------------
# NA is able to be in matrix
# but you can set the colour so it is identifiable
# the default colour is grey (how do I put this in legend)
# to change the colour use argument
# na_col


# let's try by making the na values black
ComplexHeatmap::Heatmap(mat, name = "mat", na_col = "black")
# no na values.....
# back to default colour scheme

#---------- borderds and spacing-------------
# create border by using the border true fucntion
ComplexHeatmap::Heatmap(mat, name = "mat", border = TRUE)


# add spacing between each value

#-------title-----------------
# describe what the plot is 
# can be set by column and or row
# add titles in the complexheatmap package
# so the funciton column_titles should work for the top.... 
# and the function 
# graphic paramaters can be set by the function gpar
?gpar()
# it is used by get.gpar()
get.gpar # idk why this isn't working
get.gpar(mat) # still not working

# mmmmmmm boooooo
ComplexHeatmap::Heatmap(mat, name = "mat", rect_gp = gpar(col = "white", lwd = 2))


# try with another command row_title_gp, or column_title_gp
heatmap(mat, name = "mat", col = col.fun, row_title = "Name", 
        column_title = "Hi")
# mmmm still no
# try the regular plot title function main
heatmap(mat, name = "mat", col = col.fun, main = "Name", 
        ylab = "Right Side", xlab = "bottom")
# wooo!!! 
# not sure how to get labels on the left dendrograms....
# but still cool!
# interesting that normal commands work in this package instead of the
# the suggested ones...


# come back and figure out gpar and why it is being mean


ComplexHeatmap::Heatmap(mat, name = "mat", column_title = "column title", 
                        row_title = "row title")
# now change the font and title the entire heatmap title
ComplexHeatmap::Heatmap(mat, name = "mat", column_title = "title", 
                        column_title_gp = gpar(fontsize = 15, fontface = "bold"))
# jk gpar is mean


# title angles
# in this package you can also change the angle of the titles
# very useful! 



#----clustering-------------
# maybe the most important aspect/function of heatmap visulaization
# there are many clustering methods
# two default: euclidean, and pearson both with pre-determined distance methods 
# hclust, dengrodgram (object or class) that can be/ or already are clustered


# can also turn clustering off, do for rows and then columns
ComplexHeatmap::Heatmap(mat, name = "mat", cluster_rows = FALSE)
ComplexHeatmap::Heatmap(mat, name = "mat", cluster_columns = FALSE)
# so odd looking!


# to show clustering on specififcc sides
# for example, show clustering on the right side of rows, and 
# the bottom of the columns
ComplexHeatmap:: Heatmap(mat, name = "mat", row_dend_side = "right", 
                         column_dend_side = "bottom")







